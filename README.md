# Сравнение архитектур SegNet, U-Net1 и U-Net2 для задачи сегментации изображений

## Описание проекта
Этот проект посвящен исследованию и сравнению архитектур нейронных сетей SegNet, U-Net1 и U-Net2 для задачи семантической сегментации изображений. В качестве датасета использовалась часть (0.3) датасета [DUTS](http://saliencydetection.net/duts/). Основная цель — сравнить эффективность моделей при использовании различных функций потерь (BCE Loss, Dice Loss, комбинированная Dice-BCE Loss).

## Датасет
Использовалась часть (0.3) датасета [DUTS](http://saliencydetection.net/duts/), который содержит изображения для тренировки и тестирования моделей сегментации. Датасет включает:
- **DUTS-TR**: Обучающая выборка.
- **DUTS-TE**: Тестовая выборка.

## Используемые библиотеки
Для реализации проекта использовались следующие библиотеки:

- os
- PIL
- torch
- torchvision
- numpy
- matplotlib
- decimal
- pandas


## Архитектуры моделей

### SegNet
SegNet — это архитектура с encoder-decoder структурой, разработанная для задач семантической сегментации. Основные особенности:
- **Encoder**: Состоит из сверточных слоев и слоев пулинга с запоминанием индексов для последующего upsampling.
- **Decoder**: Использует запомненные индексы для точного восстановления пространственных деталей.

### U-Net1
U-Net1 — это базовая версия U-Net, которая состоит из:
- **Encoder**: Сверточные слои с downsampling.
- **Decoder**: Сверточные слои с upsampling и skip-connections для передачи информации из encoder в decoder.

### U-Net2
U-Net2 — это улучшенная версия U-Net с дополнительными слоями и оптимизациями, такими как:
- Более глубокая архитектура.
- Улучшенные skip-connections для лучшего сохранения деталей.

## Функции потерь

### BCE Loss (Binary Cross-Entropy Loss)
Функция потерь, основанная на бинарной кросс-энтропии. Подходит для задач бинарной классификации и сегментации.

### Dice Loss
Функция потерь, основанная на метрике Dice Coefficient. Она минимизирует разницу между предсказанными и истинными масками.

### Комбинированная Dice-BCE Loss
Комбинация Dice Loss и BCE Loss, которая позволяет учитывать как точность классификации, так и совпадение масок.

## Результаты
Сравнение моделей показало следующие результаты:

| Архитектура | IoU (Train) | IoU (Test) |
|------------|------------|------------|
| **BCE Loss SegNet** | 0.444634 | 0.289137 |
| **Dice Loss SegNet** | 0.908962 | 0.366518 |
| **Dice-BCE Loss SegNet** | 0.994163 | 0.398214 |
| **Dice Loss U-Net1** | 0.840625 | 0.552679 |
| **Dice Loss U-Net2** | 0.870224 | 0.510268 |

Лучшие результаты на тестовой выборке показала модель U-Net1 с функцией Dice Loss.

